<!DOCTYPE HTML>
<!--
	Landed by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Strawberry disease detection</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="../assets/css/main.css" />
		<noscript><link rel="stylesheet" href="../assets/css/noscript.css" /></noscript>
		<!-- Favicon -->
		<link rel="icon" type="image/png" href="../images/favicon/favicon-96x96.png" sizes="96x96" />
		<link rel="icon" type="image/svg+xml" href="../images/favicon/favicon.svg" />
		<link rel="shortcut icon" href="../images/favicon/favicon.ico" />
		<link rel="apple-touch-icon" sizes="180x180" href="../images/favicon/apple-touch-icon.png" />
		<link rel="manifest" href="../images/favicon/site.webmanifest" />
	</head>
	<body class="is-preload">
		<div id="page-wrapper">

			<!-- Header -->
				<header id="header">
					<h1 id="logo"><a href="../index.html">Adam Varkoly</a></h1>
					<nav id="nav">
						<ul>
							<li><a href="../index.html">Home</a></li>
							<li><a href="projects.html">Projects</a></li>
						</ul>
					</nav>
				</header>

			<!-- Main -->
				<div id="main" class="wrapper style1">
					<div class="container">
						<header class="major">
							<h2>Exploring Fully Unsupervised Autoencoders for Early Disease Detection 
								in Strawberry Leaves using Hyperspectral Images</h2>
						</header>

						<!-- Content -->
							<section id="content">
								<h3>Summary</h3>
								<p><figure style="margin: 0; padding: 0;"><span class="image right" style="background: rgba(23, 24, 32, 0.95);"><img src="../images/strawberry/Pcactorum.png" alt="P. cactorum infection" style="background: transparent;" /><figcaption style="text-align: left; font-size: 0.9em; margin-top: 0.5em; background: rgba(23, 24, 32, 0.95);">P. cactorum infected strawberry plant</figcaption></span></figure>This project explores <b>unsupervised deep learning for early detection of Phytophthora cactorum infection in strawberry leaves using hyperspectral imaging.</b> P. cactorum infests strawberry crowns in wet and cold climate conditions and kills the plant quickly. <b>Timely detection of infestation is thus crucial</b> in strawberry farming to limit economic losses. Current, labor-intensive methods for detecting the pathogen are expensive and time-consuming, emphasizing the need for robust unsupervised methods.</p>
								<p> For fast, <b>label-free detection</b> of early infestation stage, <b>2D and 3D convolutional autoencoder architectures are explored.</b> While no configuration achieves fully satisfactory detection performance, the experiments clarify strengths and limits of unsupervised disease detection and show approaches valuable for researchers. These include demonstrating a number of steps taken to eliminate unwanted reconstruction errors, as well as introducing two novel error metrics designed to improve sensitivity in bands and regions most indicative of disease. The project also shows that a few wavelengths can be sufficient for analyzing the data, as comparable results are achieved with them to those obtained using the full spectrum.</p>
								<p> This project was my master's thesis. I wrote it in collaboration with a peer, and here I focus primarily on showing my own work.</p>
								
								<h3>A word about hyperspectral images - what we're working with</h3>
								<p>Unlike classical RGB imaging, which captures only 3 color channels (red, green, and blue), hyperspectral images record information about <b>light reflectance across hundreds of wavelengths.</b>
								This results in a high-dimensional data structure known as a <b>hypercube</b>, with arrays of two-dimensional images (spatial dimensions x, y) and one-dimensional wavelengths (spectral dimension λ).</p>
								<span class="image fit" style="background: rgba(23, 24, 32, 0.95);"><img src="../images/strawberry/hyperspectral_image.png" alt="" style="background: transparent;" /></span>
								<ul>
									<li>Each pixel in the data cube contains a detailed reflectance spectrum.</li>
									<li>This rich dimensionality has some benefits, as we have <b>very detailed data</b>, but it also poses <b>challenges for storage, processing, and analysis.</b></li>
									<li>In our data, the images are captured in the visible and near-infrared (NIR) spectrum (400-1000 nm).</li>
								</ul>

								<h3>Data</h3>
								<p><figure style="margin: 0; padding: 0;"><span class="image right" style="width: 400px; background: rgba(23, 24, 32, 0.95)"><img src="../images/strawberry/Data.png" alt="Nr. of images" style="width: 100%;" /><figcaption style="text-align: left; font-size: 0.9em; margin-top: 0.5em; background: rgba(23, 24, 32, 0.95)">Number of images in each categry.</figcaption></span></figure>The data was collected from 20 strawberry plants, some of which were deliberately infected with P. Cactorum. Images of healthy and infected plants were taken over multiple days using a hyperspectral camera operating in the visible and NIR spectrum. The spectral resolution of each image is approximately 2.55 nm, resulting in 224 spectral bands per image.</p>
								<p>Infected leaves were split into 3 groups based on the number of days elapsed since infection &rarr; Might be helpful at determining early disease.</p>
								Since the project focuses on disease symptoms on plant leaves, cropped-out images were used of the leaves. Furthermore, they are resized to have the same spatial dimensions, 256x256 pixels. Benefits:
								<ul>
									<li>Reduced spatial dimensions and overall size &rarr; computationally beneficial for storing, loading, and processing the data.</li>
									<li>Increases the relatively small number of samples (a plant usually had multiple leaves), as each leaf becomes an individual image.</li>
									<li>Every image has the same square shape which is required in a batch at training.</li>
								</ul>
								<p>Each image is accompanied by a mask that can isolate the leaf by filtering out irrelevant background pixels. Masks are utilized during the project, where appropriate.</p>

								<div style="display: flex; gap: 20px; justify-content: center; margin-top: 2em;">
									<figure style="margin: 0; padding: 0; flex: 1;">
										<div>
											<span class="image fit" style="height: 400px; margin-bottom: 0;">
												<img src="../images/strawberry/Cropped_image.png" alt="Cropping" style="background: rgba(23, 24, 32, 0.95); height: 100%; object-fit: contain;" />
											</span>
											<figcaption style="text-align: left; font-size: 0.9em; margin-top: 0.5em; padding-left: 8.15em; padding-right: 8em; padding-bottom: 2em;">Image cropping. Such smaller, cropped images are used throughout this project.</figcaption>
										</div>
									</figure>
									<figure style="margin: 0; padding: 0; flex: 1;">
										<div>
											<span class="image fit" style="height: 400px; margin-bottom: 0;">
												<img src="../images/strawberry/Mask_example.png" alt="Mask example" style="background: rgba(23, 24, 32, 0.95); height: 100%; object-fit: contain;" />
											</span>
											<figcaption style="text-align: left; font-size: 0.9em; margin-top: 0.5em; padding-left: 5.25em; padding-right: 5em; padding-bottom: 2em;">Mask and background removal. Masks can be used to filter out irrelevant background pixels.</figcaption>
										</div>
									</figure>
								</div>

								
								<b>Getting to know the data</b>
								<p><figure style="margin: 0; padding: 0;"><span class="image right" style="background: rgba(23, 24, 32, 0.95);"><img src="../images/strawberry/Pcactorum_vs_healthy_FX10.png" alt="P. cactorum vs healthy" style="background: transparent;" /><figcaption style="text-align: left; font-size: 0.9em; margin-top: 0.5em; background: rgba(23, 24, 32, 0.95);">The figure compares the spectral signature of a healthy plant to that of a symptomatic infected plant. The spectra of 1000 sampled pixels of an image is shown, alongside the mean spectral signature and its standard deviation.</figcaption></span></figure></p>
								<ul>
									<li>Spectral signature of an infected leaf on the first day is hardly distinguishable from that of a healthy leaf.</li>
									<li>As days pass after infection, some vague patterns emerge from the unhealthy plants. <b>The figure on the right shows the spectral signature of a P. cactorum infected plant, that showed visible symptoms, on its final day (with red) compared to that of a healthy plant (with blue).</b></li>
									<li>For the P. cactorum infected image the rise of reflectance values around 530-560 nm is less prevalent. The increase around 700 nm is also less rapid, but keeps on increasing slowly until the end of the spectrum the camera is capable of capturing. This could be explained by the brownish discoloring caused by P. cactorum which is observed around 700 nm.</li>
									<li>Plotting the spectra of from different areas of the leaves (rachis, veins, and the tips) suggest there might be spatial-spectral differences among healthy and infected leaves. </li>
								</ul>

								<p><b>Data Preprocessing</b></p>
								<ul>
									<li>Remove noisy bands below 430nm &rarr; <b>211 bands remain</b></li>
									<li>Replace negative intensity values with 0 (instrument errors)</li>
									<li>Normalize images</li>
									<ul>
										<li>Per-image normalization: <b>min-max scaling</b> to [0, 1]</li>
										<li>Spectral scaling <b>(Standard Normal Variate /SNV/ transformation)</b>: scales each pixel spectra separately &rarr; minimizes the impact of of 3-dimensionality of the leaves and the uneven illuminations caused by it.</li>
									</ul>
								</ul>
								<span class="image fit" style="background: rgba(23, 24, 32, 0.95);">
									<img src="../images/strawberry/Preprocessing.png" alt="Preprocessing steps" style="background: transparent;" />
									<figcaption style="text-align: left; font-size: 0.9em; margin-top: 0.5em; background: rgba(23, 24, 32, 0.95);">The effect of min-max scaling and SNV transformation on the hyperspectral image. The plots show the spectral signature of 1000 sampled pixels of an image, the mean spectra and its standard deviation.</figcaption>
								</span>

								<h3>PCA based band selection</h3>
								Working with the full hypercube poses several computational challenges. However, it is likely that the set of 211 wavelength bands is not entirely needed, as many of them are highly correlated.
								<p>A common method to reduce the spectral dimension is to utilize PCA loadings as indicators for influential bands. Following Zhang et al. (2016), a few optimal wavelengths that carry the most important information from the full spectra can be determined by selecting peaks and valleys in PC loadings.</p>
								<p><figure style="margin: 0; padding: 0;"><span class="image right" style="background: rgba(23, 24, 32, 0.95);"><img src="../images/strawberry/Hypercube_unfolding.png" alt="Hypercube unfolding" style="background: transparent;" /><figcaption style="text-align: left; font-size: 0.9em; margin-top: 0.5em; background: rgba(23, 24, 32, 0.95);">Hypercube unfolding. Reshaping the hyperspectral data cube for PCA. In the unfolded table, each row corresponds to a HSI pixel and each column represents its reflectance at a specific wavelength.</figcaption></span></figure></p>
								<b>Steps taken:</b>
								<ul>
									<li>Conduct PCA on pixels from healthy and infected leaves.<br>Since the hyperspectral data cube is 3-dimensional, to accustom the data to a format PCA can be applied on, individual pixels are considered as data points with their spectral dimension as features. (&rarr; this is called "unfolding") <br> Each image can be reshaped to a long table, with relevant ROI pixels (those obtained after filtering for the leaves with the masks) acting as rows, and their reflectance values at different wavelengths as columns.
									</li>
									<li>Determine the number of PCs to retain (partly based on scree-plot, more based on PC score images).</li>
									<li>Select important wavelengths based on highs and lows in the PC loadings. (Following Zhang et al. (2016), Li et al. (2018), Vargas et al. (2005).)</li>
								</ul>
								<span class="image fit" style="background: rgba(23, 24, 32, 0.95);">
									<img src="../images/strawberry/PCA_Score_images.png" alt="" style="background: transparent;" />
									<figcaption style="text-align: left; font-size: 0.9em; margin-top: 0.5em; background: rgba(23, 24, 32, 0.95);">Principal component score images. False-color RGB images of one healthy and three infected images are shown alongside their corresponding PC score images. In the score images, lighter (whiter) pixels indicate higher PC scores, while darker pixels represent lower scores.</figcaption>
								</span>

								While the 8<sup>th</sup> principal component mainly captures noise, the first seven components seem to contain meaningful information &rarr; <b>7 PCs retained</b>.

								<p><figure style="margin: 0; padding: 0;"><span class="image left" style="background: rgba(23, 24, 32, 0.95);"><img src="../images/strawberry/PCA_loadings_bandselect.png" alt="" style="background: transparent;" /><figcaption style="text-align: left; font-size: 0.9em; margin-top: 0.5em; background: rgba(23, 24, 32, 0.95);">Principal component loadings and selected wavelengths. PCA is conducted on the unfolded hyperspectral data from healthy and infected leaves. Loadings of the first seven PCs are shown with important wavelengths marked and the final selected bands are indicated by dashed lines.</figcaption></span></figure></p>
								Loadings are the correlations between the original features (wavelengths) and the principal components:
								<ul style="margin-left: 30em;">
									<li>They essentially tell how much each original variable (wavelength) contributes to the principal component.</li>
									<li>Highs and lows mean the given wavelength contributes relatively more (or relatively less) to the given PC. Since neighboring wavelengths are correlated, <b>peaks and valleys indicate relatively more importance compared to the neighboring wavelengths</b> &rarr; indicating important wavelengths.</li>
								</ul>
								&rArr; <b>15 wavelengths</b> are selected based on highs and lows in loadings.
								<br>
								&rArr; <b>2 Wavelengths</b> added manually. Because no wavelength was selected above 800 nm based on loading highs and lows, but prior data exploration indicated that this region contains differences between the spectra of healthy and diseased leaves, thus might be important.

							</section>

					</div>
				</div>

			<!-- Footer -->
				<footer id="footer">
					<ul class="icons">
						<!-- <li><a href="#" class="icon brands alt fa-twitter"><span class="label">Twitter</span></a></li>-->
						<!-- <li><a href="#" class="icon brands alt fa-facebook-f"><span class="label">Facebook</span></a></li>-->
						<li><a href="https://www.linkedin.com/in/ádám-varkoly-5970231b9" class="icon brands alt fa-linkedin-in"><span class="label">LinkedIn</span></a></li>
						<!-- <li><a href="#" class="icon brands alt fa-instagram"><span class="label">Instagram</span></a></li>-->
						<li><a href="https://github.com/varkolya" class="icon brands alt fa-github"><span class="label">GitHub</span></a></li>
						<!-- <li><a href="#" class="icon solid alt fa-envelope"><span class="label">Email</span></a></li>-->
					</ul>
					<ul class="copyright">
						<li>&copy; <script>document.write(new Date().getFullYear())</script> Adam Varkoly. All rights reserved.</li>
					</ul>
				</footer>

		</div>

		<!-- Scripts -->
			<script src="../assets/js/jquery.min.js"></script>
			<script src="../assets/js/jquery.scrolly.min.js"></script>
			<script src="../assets/js/jquery.dropotron.min.js"></script>
			<script src="../assets/js/jquery.scrollex.min.js"></script>
			<script src="../assets/js/browser.min.js"></script>
			<script src="../assets/js/breakpoints.min.js"></script>
			<script src="../assets/js/util.js"></script>
			<script src="../assets/js/main.js"></script>

	</body>
</html>